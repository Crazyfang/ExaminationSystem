<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>部门总览</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  {% load static %}
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="{% static 'layui/css/layui.css' %}" media="all">
  <link rel="stylesheet" href="{% static 'css/dtree/dtree.css' %}" media="all">
  <link rel="stylesheet" href="{% static 'css/dtree/font/dtreefont.css' %}" media="all">
  <link rel="stylesheet" href="{% static 'css/admin.css' %}" media="all">
</head>
<body>
    {% csrf_token %}
  <div class="layui-fluid">
    <div class="layui-row layui-col-space15">
      <div class="layui-col-sm12">
        <div class="layui-card">
          <div class="layui-card-header">
            部门列表
            <div class="layui-btn-group layuiadmin-btn-group">
              <a href="javascript:;" class="layui-btn layui-btn-primary">增加</a>
              <a href="javascript:;" class="layui-btn layui-btn-primary">删除</a>
              <a href="javascript:;" class="layui-btn layui-btn-primary">编辑</a>
            </div>
          </div>
          <div class="layui-card-body">
            <div class="layui-row">
              <div class="layui-col-sm12">
                  <ul id="commonTree0" class="dtree" data-id="0"></ul>
{#                  <div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-pagetwo">#}
{#                    <div carousel-item id="LAY-index-pagetwo">#}
{#                      <div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>#}
{#                    </div>#}
{#                  </div>#}
              </div>
            </div>
          </div>
        </div>
      </div>
      </div>
    </div>
  </div>

  <script src="{% static 'layui/layui.js' %}"></script>
  <script src="{% static 'js/jquery.min.js' %}"></script>
  <script src="{% static 'js/csrf.js' %}"></script>
  <script>
  layui.config({
    base: '{% static '' %}' //静态资源所在路径
  }).extend({
    index: 'lib/index' //主入口模块
  }).use(['index', 'dtree', 'element', 'layer'], function () {
        var $ = layui.$,
            dtree = layui.dtree,
            element = layui.element,
            layer = layui.layer;

        var DemoTree = dtree.render({
          elem: "#commonTree0",
          dataStyle: "layuiStyle",  //使用layui风格的数据格式
          response:{message:"msg",statusCode:0},  //修改response中返回数据的定义
          {#data: commonTree0,#}
          url:'{% url 'department:department_list' %}'
        });

        $('.layui-btn').click(function () {
            var param = dtree.getNowParam(DemoTree);

            if($(this).text() === '增加'){
                if(!$.isEmptyObject(param)){
                    layer.open({
                        type:2,
                        content:'{% url 'department:create_view' 828010 %}',
                        offset:'auto',
                        area:['500px', '300px'],
                        shadeClose:true
                    });
                }
                else{
                    layer.open({
                        type:2,
                        content:'{% url 'department:create_view' 0 %}',
                        offset:'auto',
                        area:['500px', '300px'],
                        shadeClose:true
                    });
                }
            }
            else if($(this).text() === '编辑')
            {
                layer.msg('编辑!');
            }
            else{
                layer.msg('删除!');
            }
        });

        dtree.on("node('commonTree0')" ,function(obj){
            var param = dtree.getNowParam(DemoTree);
            console.log(param);
        });
  });
  </script>
</body>
</html>